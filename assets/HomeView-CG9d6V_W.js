import{d as z,r as B,g as ge,h as D,o as f,i as W,w as He,j as y,k as oe,v as Ce,t as K,l as Ut,m as tt,n as v,p as _t,q as bt,F as ct,s as gt,x as pt,c as rt,y as dt,z as Ie,T as De,A as ye,B as Ae,C as Ht,D as ie,u as F,E as Ee}from"./vendor-vue-BJjdFApe.js";import{j as At,k as se,s as we,l as xe,m as ke,n as ce,p as re,q as Le,t as zt}from"./firebase-1f7lkskc.js";import{L as Jt,a as Re,C as le,b as Vt,i as Te,S as U,m as g,u as Z,c as Tt,d as nt,e as ue,g as mt,f as Mt,h as ft,N as Me,j as Wt,k as $e,H as Be,l as Ne,n as Pe,o as Ue}from"./index-CNpNIIcx.js";import{_ as J}from"./_plugin-vue_export-helper-DlAUqK2U.js";const Ve={class:"auth-shell"},We=["disabled"],Oe={key:1,class:"auth-current"},Fe={class:"auth-current__text"},je={key:2,class:"auth-form__status"},Ge={key:3,class:"auth-form__error"},Ke=z({__name:"Auth",setup(a){const n=B(window.localStorage.getItem(Jt)??""),e=B(!1),o=B(""),i=B(""),c=B(null),p=At();ge(()=>{se(p,_=>{c.value=_})});const H=async()=>{i.value="",o.value="";const _=n.value.trim();if(!_){i.value="Enter an email to continue.";return}e.value=!0;try{await xe(p,_,Re),window.localStorage.setItem(Jt,_),o.value=`Sign-in link sent to ${_}`}catch(u){console.error("Error sending sign-in link:",u),i.value="Unable to send link. Please try again."}finally{e.value=!1}},m=async()=>{try{await we(p),o.value="Signed out."}catch(_){console.error("Failed to sign out",_),i.value="Unable to sign out. Please retry."}};return(_,u)=>(f(),D("section",Ve,[c.value?(f(),D("div",Oe,[y("p",Fe,[u[2]||(u[2]=Ut("Signed in as: ",-1)),y("strong",null,K(c.value?.email),1)]),y("button",{class:"auth-form__submit",type:"button",onClick:m},"Log Out")])):(f(),D("form",{key:0,class:"auth-form",onSubmit:He(H,["prevent"])},[u[1]||(u[1]=y("label",{for:"email-input",class:"auth-form__label"},"Email",-1)),oe(y("input",{"onUpdate:modelValue":u[0]||(u[0]=d=>n.value=d),type:"email",id:"email-input",class:"auth-form__input",placeholder:"you@example.com",autocomplete:"email",required:""},null,512),[[Ce,n.value]]),y("button",{class:"auth-form__submit",type:"submit",disabled:e.value},K(e.value?"Sending...":"Send Sign-In Link"),9,We)],32)),o.value?(f(),D("p",je,K(o.value),1)):W("",!0),i.value?(f(),D("p",Ge,K(i.value),1)):W("",!0)]))}}),ze=J(Ke,[["__scopeId","data-v-1d072d57"]]),Je=["aria-expanded"],Qe={key:0,class:"profile-menu__panel",role:"dialog","aria-label":"Profile menu"},Ye=z({__name:"ProfileMenu",setup(a){const n=B(!1),e=o=>{n.value=o};return(o,i)=>(f(),D("div",{class:"profile-menu",onMouseenter:i[0]||(i[0]=c=>e(!0)),onMouseleave:i[1]||(i[1]=c=>e(!1))},[y("button",{class:"profile-menu__button",type:"button","aria-haspopup":"true","aria-expanded":n.value?"true":"false"},[...i[2]||(i[2]=[y("svg",{class:"profile-menu__icon",viewBox:"0 0 24 24",role:"img","aria-label":"Profile"},[y("circle",{cx:"12",cy:"8",r:"4"}),y("path",{d:"M4 20c0-3.3137 3.134-6 8-6s8 2.6863 8 6"})],-1)])],8,Je),n.value?(f(),D("div",Qe,[tt(ze)])):W("",!0)],32))}}),qe=J(Ye,[["__scopeId","data-v-c1f0909d"]]),Et="/bjk/flag-wave.gif",wt="/bjk/bjWin.gif",Xe=["aria-label"],xt=64,kt=64,It=1,Qt=14,Yt=4,Ze=z({__name:"PlayingCard",props:{suit:{},rank:{},large:{type:Boolean}},setup(a){const n=Qt*xt+(Qt-1)*It,e=Yt*kt+(Yt-1)*It,o={row:1,column:13},i=["A","2","3","4","5","6","7","8","9","10","J","Q","K"],c=["hearts","diamonds","clubs","spades"],p={A:"A",ACE:"A",1:"A","01":"A","02":"2",2:"2",TWO:"2","03":"3",3:"3",THREE:"3","04":"4",4:"4",FOUR:"4","05":"5",5:"5",FIVE:"5","06":"6",6:"6",SIX:"6","07":"7",7:"7",SEVEN:"7","08":"8",8:"8",EIGHT:"8","09":"9",9:"9",NINE:"9",10:"10",T:"10",TEN:"10",J:"J",JACK:"J",Q:"Q",QUEEN:"Q",K:"K",KING:"K"},H={HEARTS:"hearts",HEART:"hearts",H:"hearts",DIAMONDS:"diamonds",DIAMOND:"diamonds",D:"diamonds",CLUBS:"clubs",CLUB:"clubs",C:"clubs",SPADES:"spades",SPADE:"spades",S:"spades"},m=a,_=v(()=>m.large?le:Vt),u=v(()=>{if(m.rank===void 0||m.rank===null)return null;const b=`${m.rank}`.trim().toUpperCase();return p[b]??null}),d=v(()=>{if(!m.suit)return null;const b=m.suit.trim().toUpperCase();return H[b]??null}),r=v(()=>{const b=u.value,E=d.value;if(!b||!E)return o;const T=i.indexOf(b),P=c.indexOf(E);return T===-1||P===-1?o:{row:P,column:T}}),l=new URL("/bjk/kenney_playing-cards-pack/Tilesheet/cardsLarge_tilemap.png",import.meta.url).href,M=v(()=>{const{row:b,column:E}=r.value,T=-E*(xt+It),P=-b*(kt+It),A=_.value;return{width:`${xt*A}px`,height:`${kt*A}px`,backgroundImage:`url(${l})`,backgroundPosition:`${T*A}px ${P*A}px`,backgroundSize:`${n*A}px ${e*A}px`}}),C=v(()=>{const b=u.value,E=d.value;return!b||!E?"Card back":`${b} of ${E}`});return(b,E)=>(f(),D("div",{class:"playing-card",style:_t(M.value),role:"img","aria-label":C.value},null,12,Xe))}}),tn=J(Ze,[["__scopeId","data-v-72c1efd8"]]),en=46,nn=64,qt=13,an=220,Xt=320,on=z({__name:"CardHand",props:{cards:{},maxWidth:{},large:{type:Boolean}},setup(a){const n=a,e=v(()=>n.large?le:Vt),o=v(()=>en*e.value),i=v(()=>nn*e.value),c=v(()=>o.value+(qt-1)*(o.value/4)),p=v(()=>n.maxWidth??c.value),H=v(()=>n.large??!1),m=v(()=>n.cards.slice(0,qt)),_=B([]),u=v(()=>_.value),d=v(()=>{const I=_.value.length;if(I<=1)return 0;const N=Math.max(p.value-o.value,0)/(I-1),L=Math.min(N,o.value);return Math.max(L,o.value/4)}),r=v(()=>{const I=_.value.length;return I===0?0:o.value+d.value*(I-1)}),l=v(()=>({maxWidth:`${p.value}px`,width:`${Math.min(r.value,p.value)}px`,height:`${i.value}px`})),M=v(()=>_.value.map((I,k)=>({left:`${k*d.value-8}px`,zIndex:k+1}))),C=[],b=[];let E=0,T=!1;const P=(I,k)=>({id:++E,value:I.value,suit:I.suit,rank:I.rank,isEntering:k}),A=()=>{for(;b.length;){const I=b.pop();I!==void 0&&clearTimeout(I)}},j=I=>{_.value=_.value.map(k=>k.id===I?{...k,isEntering:!1}:k)},V=(I,k)=>{const N=setTimeout(()=>{const L=b.indexOf(N);L!==-1&&b.splice(L,1),I()},k);b.push(N)},O=()=>{if(T)return;T=!0;const I=()=>{const k=C.shift();if(!k){T=!1;return}const N=P(k,!0);_.value=[..._.value,N],V(()=>j(N.id),Xt),V(I,an)};I()},at=I=>{I.length!==0&&(C.push(...I),O())},q=I=>{A(),C.length=0,T=!1,_.value=I.map(k=>P(k,!1))};return bt(m,I=>{const k=_.value,N=I.length;if(k.length===0&&N===0)return;if(k.length>0&&N===0){q([]);return}const L=Math.min(k.length,N),G=k.slice(0,L).map((et,x)=>{const R=I[x];if(et.value===R.value&&et.suit===R.suit)return et;const S=P(R,!0);return V(()=>j(S.id),Xt),S});if(_.value=G,N<k.length){A(),C.length=0,T=!1;return}const X=I.slice(G.length);at(X)},{immediate:!0}),pt(()=>{A()}),(I,k)=>(f(),D("div",{class:"card-hand",style:_t(l.value),role:"group","aria-label":"Card hand"},[(f(!0),D(ct,null,gt(u.value,(N,L)=>(f(),rt(tn,{key:N.id,class:dt(["card-hand__card",{"card-hand__card--entering":N.isEntering}]),style:_t(M.value[L]),rank:N.rank,suit:N.suit,large:H.value},null,8,["class","style","rank","suit","large"]))),128))],4))}}),Dt=J(on,[["__scopeId","data-v-a44007ea"]]),sn={class:"result-counter__prefix"},cn={class:"result-counter__value"},rn=z({__name:"ResultCounter",props:{amount:{},active:{type:Boolean},result:{},durationMs:{},direction:{}},setup(a){const n=a,e=B(0),o=B(!1);let i=null;const c=l=>{switch(l){case"Surrendered":case"Lose":case"Double_Lose":return"down";case"Win":case"BlackJack_Win":case"Double_Win":return"up";case"Push":case"Double_Push":return"push";default:return"push"}},p=v(()=>n.direction??c(n.result)),H=v(()=>n.durationMs??900),m=v(()=>p.value==="up"?"+":p.value==="down"?"-":"±"),_=v(()=>`result-counter--${p.value}`),u=()=>{i!==null&&(cancelAnimationFrame(i),i=null)},d=()=>{u();const l=Math.max(n.amount,0),M=p.value;if(!n.active||l<=0){o.value=!1,e.value=M==="down"?l:0;return}o.value=!0;const C=M==="down"?l:0,E=(M==="down"?0:l)-C,T=performance.now(),P=A=>{const j=A-T,V=Math.min(j/H.value,1),O=C+E*V;e.value=Math.round(O),V<1?i=requestAnimationFrame(P):(i=null,o.value=!1)};e.value=C,i=requestAnimationFrame(P)};bt(()=>({amount:n.amount,active:n.active,direction:p.value}),(l,M)=>{const{amount:C,active:b}=l,E=M?.amount,T=M?.active;if(C<=0){o.value=!1,u(),e.value=0;return}if(!b){u(),o.value=!1,e.value=p.value==="down"?Math.max(C,0):0;return}b&&(!T||C!==E)&&d()},{immediate:!0}),Ie(()=>{u()});const r=v(()=>e.value.toLocaleString());return(l,M)=>(f(),rt(De,{name:"result-counter"},{default:ye(()=>[o.value?(f(),D("div",{key:0,class:dt(["result-counter",_.value]),role:"status","aria-live":"polite"},[y("span",sn,K(m.value),1),y("span",cn,K(r.value),1)],2)):W("",!0)]),_:1}))}}),Lt=J(rn,[["__scopeId","data-v-b592d668"]]),ln={class:"betting-slider",role:"group","aria-label":"Bet amount selector"},un={class:"betting-slider__body"},dn={class:"betting-slider__value","aria-live":"polite"},_n=["disabled"],hn=["disabled"],pn=["value","disabled"],lt=0,Rt=3e4,St=500,vn=z({__name:"BettingSlider",props:{initialValue:{},showSlider:{type:Boolean},disabled:{type:Boolean}},emits:["change","update:value"],setup(a,{emit:n}){const e=a,o=n,i=C=>{const b=Math.min(Rt,Math.max(lt,C)),E=Math.round((b-lt)/St);return lt+E*St},c=B(i(e.initialValue??lt)),p=v(()=>e.disabled??!1),H=v(()=>c.value<=lt),m=v(()=>c.value>=Rt),_=()=>{const C=c.value;o("update:value",C),o("change",C)},u=v(()=>`$${(c.value/100).toLocaleString("en-US")}`),d=C=>{c.value=i(C)},r=()=>{p.value||m.value||d(c.value+St)},l=()=>{p.value||H.value||d(c.value-St)},M=C=>{if(p.value)return;const b=C.target;if(!b)return;const E=Number.parseInt(b.value,10);Number.isNaN(E)||d(E)};return bt(()=>e.initialValue,C=>{if(C!==void 0&&!Number.isNaN(C)){const b=i(C);b!==c.value&&(c.value=b)}}),bt(c,_),(C,b)=>(f(),D("div",ln,[y("div",un,[y("div",dn,[y("button",{type:"button",class:"betting-slider__control","aria-label":"Decrease bet",onClick:l,disabled:p.value||H.value}," − ",8,_n),Ut(" "+K(u.value)+" ",1),y("button",{type:"button",class:"betting-slider__control","aria-label":"Increase bet",onClick:r,disabled:p.value||m.value}," + ",8,hn)]),oe(y("input",{ref:"sliderRef",class:"betting-slider__range",type:"range",min:lt,max:Rt,step:St,value:c.value,"aria-label":"Bet amount slider",disabled:p.value,onInput:M},null,40,pn),[[Ae,e.showSlider]])])]))}}),Sn=J(vn,[["__scopeId","data-v-3849889f"]]),yt="play",ht="reshuffle",ut="playerAction",Ot=Ht("chairs",()=>{const a=B(null),n=ie({}),e=v(()=>{const t=a.value;return Te(t)?n[t]:null}),o=new Map,i=[],c=U.getInstance().table,p=v(()=>Object.values(n).some(t=>t.modelHands.some(s=>s.length>0))),H=t=>t.map(s=>[...s]),m=t=>t.hands.map(s=>[...s.cards]),_=new Set(["Win","Double_Win"]),u=new Set(["Lose","Double_Lose"]),d=new Set(["Surrendered"]),r=new Set(["Push","Double_Push"]),l={Lose:1,Double_Lose:2},M={Win:2,Double_Win:4},C=1+U.getInstance().rules.blackjackPayout,b=(t,s)=>{if(!t)return 0;const h=s/100;return h<=0?0:d.has(t)?h/2:u.has(t)?(l[t]??1)*h:_.has(t)?(M[t]??2)*h:r.has(t)?0:t==="BlackJack_Win"?Math.floor(h*C):0},E=t=>t.hands.map(s=>{const h=s.lastOutcome??null;return{result:h,amount:b(h,t.bet??0)}}),T=t=>t.reduce((s,h)=>s+h.length,0),P=t=>{if(!t)return null;for(const[s,h]of o.entries())if(h.chair===t)return s;for(const[s,h]of Object.entries(c.playerChairs))if(h===t)return Number(s);return null},A=(t,s=!1)=>{const h=n[t],w=o.get(t);if(!h||!w)return;const $=m(w.chair),Q=E(w.chair);h.modelHands=H($);const it=T($),st=T(h.hands),Ct=w.chair.activeHandIndex;if(!(it===0&&st>0&&!s)){if($.length===0){h.clampedActiveHandIndex=null,h.hands=[],h.handResults=[];return}h.clampedActiveHandIndex=Math.min(Math.max(Ct,0),$.length-1),h.hands=H($),h.handResults=[...Q]}},j=()=>{for(const t of Object.keys(n).map(Number))A(t,!0)};g.on(Z(ht),()=>{j()});const V=(t,s)=>{const h=t.handListeners.get(s);if(h)try{h()}finally{t.handListeners.delete(s)}},O=(t,s)=>{const h=o.get(t);if(!h)return;const w=mt(s);if(!w)throw new Error("Hand instance ID not found");if(h.handListeners.has(w))return;const $=()=>{A(t)},Q=ft("hand",Wt,w),it=ft("hand",$e,w),st=ft("hand",Be,w);g.on(Q,$),g.on(it,$),g.on(st,$),h.handListeners.set(w,()=>{g.off(Q,$),g.off(it,$),g.off(st,$)})},at=t=>{const s=o.get(t);if(!s)return;const h=s.chair,w=new Set;for(const $ of h.hands){const Q=mt($);if(!Q)throw new Error("Hand instance ID not found");w.add(Q),O(t,$)}for(const $ of[...s.handListeners.keys()])w.has($)||V(s,$);A(t)},q=t=>{const s=o.get(t);if(s){for(const h of s.cleanupFns)try{h()}catch(w){console.error("Failed to cleanup chair listener",w)}s.cleanupFns.length=0;for(const h of[...s.handListeners.keys()])V(s,h);o.delete(t),delete n[t]}},I=(t,s)=>{q(t);const h=mt(s);if(!h)throw new Error("Chair instance ID not found");const w=m(s),$=E(s);n[t]={hands:w,modelHands:H(w),handResults:[...$],activeHandIndex:s.activeHandIndex,bet:s.bet??0,clampedActiveHandIndex:w.length>0?Math.min(Math.max(s.activeHandIndex,0),w.length-1):null};const Q={chair:s,chairInstanceId:h,handListeners:new Map,cleanupFns:[]},it=Mt("chair","activeHandIndex",h),st=ot=>{const Y=n[t];if(!Y)return;const vt=typeof ot.value=="number"?ot.value:Number(ot.value??Y.activeHandIndex);Y.activeHandIndex=Number.isNaN(vt)?Y.activeHandIndex:vt,at(t)};g.on(it,st),Q.cleanupFns.push(()=>g.off(it,st));const Ct=Mt("chair","bet",h),jt=ot=>{const Y=n[t];if(!Y)return;const vt=typeof ot.value=="number"?ot.value:Number(ot.value??Y.bet);Y.bet=Number.isNaN(vt)?Y.bet:vt};g.on(Ct,jt),Q.cleanupFns.push(()=>g.off(Ct,jt));const Gt=ft("chair",Me,h),Kt=ot=>{const Y=ot.value;Y&&O(t,Y),A(t)};g.on(Gt,Kt),Q.cleanupFns.push(()=>g.off(Gt,Kt)),o.set(t,Q),at(t)},k=()=>{for(const[t,s]of Object.entries(c.playerChairs))s&&I(Number(t),s)},N=t=>{const s=t.value,h=t.previous;if(h){const w=P(h);w!==null&&q(w)}if(s){const w=P(s);if(w===null)throw new Error("Could not determine chair index for new chair");I(w,s)}},L=Tt("table",ue);g.on(L,N),i.push(()=>g.off(L,N));const G=nt("table","chairTurnIndex"),X=t=>{const s=typeof t.value=="number"?t.value:Number(t.value??-1);a.value=s>=0?s:null};return g.on(G,X),i.push(()=>g.off(G,X)),a.value=c.chairTurnIndex>=0?c.chairTurnIndex:null,k(),pt(()=>{for(const t of i)try{t()}catch(s){console.error("Failed to cleanup chair store listener",s)}i.length=0;for(const t of[...o.keys()])q(t)}),{activeChairId:a,activeChair:e,getChairView:t=>n[t]??null,roundInProgress:p,sit:t=>{p.value||U.getInstance().table.addPlayerChair(t)},adjustBet:(t,s)=>{if(p.value)return;const h=o.get(t)?.chair;h&&(h.bet=Math.max(s,0))},leave:t=>{p.value||U.getInstance().table.removePlayerChair(t)}}}),fn=["aria-current"],mn={class:"hand__top","aria-label":"Inactive hands"},bn={class:"hand__top-stack hand__top-stack--left","aria-label":"Hands before active"},gn={key:0,class:"hand__ellipsis","aria-hidden":"true"},Hn=["aria-pressed"],Cn={class:"hand__entry-body"},In={key:1,class:"hand__surrender-flag","aria-hidden":"true"},Dn={key:2,class:"hand__bj-win","aria-hidden":"true"},yn={class:"hand__top-stack hand__top-stack--right","aria-label":"Hands after active"},An={key:0,class:"hand__ellipsis","aria-hidden":"true"},En=["aria-pressed"],wn={class:"hand__entry-body"},xn={key:1,class:"hand__surrender-flag","aria-hidden":"true"},kn={key:2,class:"hand__bj-win","aria-hidden":"true"},Ln={class:"hand",role:"group","aria-label":"Card hands"},Rn={key:0,class:"hand__frame"},Tn={class:"hand__entry-body"},Mn={key:1,class:"hand__surrender-flag","aria-hidden":"true"},$n={key:2,class:"hand__bj-win","aria-hidden":"true"},Zt=8,te=2,Bn=z({__name:"Chair",props:{chairId:{},maxWidth:{},initialActiveHand:{}},setup(a){const e=64*Vt/2,o=new Set(["Win","Double_Win"]),i=new Set(["Surrendered"]),c=new Set(["BlackJack_Win"]),p=new Set(["Lose","Double_Lose"]),H=new Set(["Push","Double_Push"]),m=a,_=B(null),u=Ot(),d=v(()=>u.activeChairId===m.chairId),r=v(()=>u.getChairView(m.chairId)),l=v(()=>!u.roundInProgress),M=v(()=>r.value?.hands.slice(0,Zt)??[]),C=v(()=>r.value?.handResults.slice(0,Zt)??[]),b=v(()=>m.maxWidth),E=v(()=>r.value?.bet??0),T=v(()=>M.value.map((x,R)=>{const S=C.value[R]??null,t=S?.result??null,s=S?.amount??0,h=x.length>0;return{hand:x,index:R,result:t,resultAmount:s,showResultHighlight:!!(t&&h)}})),P=v(()=>{const x=r.value;if(!x)return _.value=null,0;const{hands:R,activeHandIndex:S,clampedActiveHandIndex:t}=x,s=R.length;if(t!==null?t>=0&&t<s:S>=0&&S<s){const $=t!==null?t:S;return _.value=$,$}if(s===0)return _.value=null,0;const w=_.value!==null&&_.value<s?_.value:s-1;return _.value=w,w}),A=v(()=>T.value.find(x=>x.index===P.value)??null),j=P,V=v(()=>T.value.filter(x=>x.index<P.value)),O=v(()=>T.value.filter(x=>x.index>P.value)),at=v(()=>V.value.slice(Math.max(V.value.length-te,0),V.value.length)),q=v(()=>O.value.slice(0,Math.min(te,O.value.length)).reverse()),I=v(()=>Math.max(V.value.length-at.value.length,0)),k=v(()=>Math.max(O.value.length-q.value.length,0)),N=x=>x.map((R,S,t)=>({...R,style:{marginTop:S===0?"0":`-${e}px`,zIndex:t.length-S}})),L=v(()=>N(at.value)),G=v(()=>N(q.value)),X=x=>{u.adjustBet(m.chairId,x)},et=x=>{const R=!!x?.hand.length,S=!!(x?.result&&o.has(x.result)&&R),t=!!(x?.result&&p.has(x.result)&&R),s=!!(x?.result&&H.has(x.result)&&R),h=!!(x?.result&&i.has(x.result)&&R),w=!!(x?.result&&c.has(x.result)&&R),$=!!x?.showResultHighlight;return{"hand__entry--win":S,"hand__entry--lose":t,"hand__entry--push":s,"hand__entry--surrender":h,"hand__entry--bj-win":w,"hand__entry--bj-win-active":!!(w&&$),"hand__entry--win-active":!!(S&&$),"hand__entry--loss-active":!!(t&&$),"hand__entry--push-active":!!(s&&$),"hand__entry--surrender-active":!!(h&&$)}};return bt(()=>M.value.length,x=>{x===0&&(_.value=null)}),(x,R)=>(f(),D("div",{class:dt(["chair",{"chair--active":d.value}]),"aria-label":"Player Spot","aria-current":d.value?"true":void 0},[F(u).roundInProgress?W("",!0):(f(),D("button",{key:0,class:"chair__deactivate",type:"button","aria-label":"Make this chair inactive",onClick:R[0]||(R[0]=S=>F(u).leave(m.chairId))}," × ")),y("div",mn,[y("div",bn,[I.value>0?(f(),D("span",gn,K(".".repeat(I.value)),1)):W("",!0),(f(!0),D(ct,null,gt(L.value,S=>(f(),D("div",{key:S.index,class:dt(["hand__entry","hand__entry--stack",et(S)]),type:"button",role:"listitem",style:_t(S.style),"aria-pressed":S.index===F(j)},[y("div",Cn,[tt(Dt,{cards:S.hand,maxWidth:b.value},null,8,["cards","maxWidth"]),S.result&&S.resultAmount>0?(f(),rt(Lt,{key:0,amount:S.resultAmount,active:S.showResultHighlight,result:S.result},null,8,["amount","active","result"])):W("",!0),S?.result&&F(i).has(S.result)&&S.showResultHighlight?(f(),D("div",In,[...R[1]||(R[1]=[y("img",{src:Et,alt:"Surrender flag"},null,-1)])])):W("",!0),S?.result&&F(c).has(S.result)&&S.showResultHighlight?(f(),D("div",Dn,[...R[2]||(R[2]=[y("img",{src:wt,alt:"Blackjack win animation"},null,-1)])])):W("",!0)])],14,Hn))),128))]),y("div",yn,[k.value>0?(f(),D("span",An,K(".".repeat(k.value)),1)):W("",!0),(f(!0),D(ct,null,gt(G.value,S=>(f(),D("div",{key:S.index,class:dt(["hand__entry","hand__entry--stack",et(S)]),type:"button",role:"listitem",style:_t(S.style),"aria-pressed":S.index===F(j)},[y("div",wn,[tt(Dt,{cards:S.hand,maxWidth:b.value},null,8,["cards","maxWidth"]),S.result&&S.resultAmount>0?(f(),rt(Lt,{key:0,amount:S.resultAmount,active:S.showResultHighlight,result:S.result},null,8,["amount","active","result"])):W("",!0),S?.result&&F(i).has(S.result)&&S.showResultHighlight?(f(),D("div",xn,[...R[3]||(R[3]=[y("img",{src:Et,alt:"Surrender flag"},null,-1)])])):W("",!0),S?.result&&F(c).has(S.result)&&S.showResultHighlight?(f(),D("div",kn,[...R[4]||(R[4]=[y("img",{src:wt,alt:"Blackjack win animation"},null,-1)])])):W("",!0)])],14,En))),128))])]),y("div",Ln,[A.value?(f(),D("div",Rn,[y("button",{class:dt(["hand__entry","hand__entry--active",et(A.value)]),type:"button","aria-pressed":!0},[y("div",Tn,[tt(Dt,{cards:A.value.hand,large:!0,maxWidth:b.value},null,8,["cards","maxWidth"]),A.value.result&&A.value.resultAmount>0?(f(),rt(Lt,{key:0,amount:A.value.resultAmount,active:A.value.showResultHighlight,result:A.value.result},null,8,["amount","active","result"])):W("",!0),A.value?.result&&F(i).has(A.value.result)&&A.value.showResultHighlight?(f(),D("div",Mn,[...R[5]||(R[5]=[y("img",{src:Et,alt:"Surrender flag"},null,-1)])])):W("",!0),A.value?.result&&F(c).has(A.value.result)&&A.value.showResultHighlight?(f(),D("div",$n,[...R[6]||(R[6]=[y("img",{src:wt,alt:"Blackjack win animation"},null,-1)])])):W("",!0)])],2)])):W("",!0)]),tt(Sn,{"initial-value":E.value,onChange:X,disabled:!l.value},null,8,["initial-value","disabled"])],10,fn))}}),Nn=J(Bn,[["__scopeId","data-v-e7b6d617"]]),Pn={class:"chair","aria-label":"Player Spot",style:{width:"272px"}},Un=["disabled"],Vn={key:0,class:"chair__inactive-label"},Wn={key:1,"aria-hidden":"true"},On=z({__name:"InactiveChair",props:{chairId:{}},setup(a){const n=a,e=Ot(),o=()=>{e.roundInProgress||e.sit(n.chairId)};return(i,c)=>(f(),D("div",Pn,[y("button",{class:"chair__empty-button",type:"button","aria-label":"Sit at this chair",disabled:F(e).roundInProgress,onClick:o},[F(e).roundInProgress?(f(),D("span",Vn," Round Active ")):(f(),D("span",Wn,"+"))],8,Un)]))}}),Fn=J(On,[["__scopeId","data-v-003a3a6f"]]),de=a=>`plyr_${a}`,$t="Players",_e=ke(Ne),jn=async(a,n)=>{const e=ce(_e,a,...n),o=await re(e);return o.exists()?o.data():null},he=async(a,n,e)=>{const o=ce(_e,a,...n),i=await re(o),c={...e,updatedAt:zt()};return i.exists()||(c.createdAt=zt()),Le(o,c,{merge:!0})},Bt=async(a,n,e)=>he($t,[de(a),...n],e),Gn=0,Kn=5e6,ee=nt("player","balance"),zn=Ht("player",()=>{const a=Ee(U.getInstance()),n=B(Gn),e=At(),o=B(e.currentUser?.uid??null),i=B(!1),c=d=>Math.max(0,Math.floor(d)),p=d=>{const r=c(d),l=a.player.balance;if(r===l){n.value=l;return}r>l?a.player.addMoney(r-l):a.player.removeMoney(l-r)},H=d=>{!Number.isFinite(d)||d===0||p(a.player.balance+d)},m=async(d,r)=>{try{await he($t,[d],{balance:r})}catch(l){console.error("Failed to persist player balance",l)}},_=async d=>{i.value=!0;try{const l=(await jn($t,[d]))?.balance??null,M=typeof l=="number"?l:Kn;p(M),l===null&&await m(d,M)}catch(r){console.error("Failed to hydrate player balance",r)}finally{i.value=!1}},u=d=>{const r=Number(d.value);n.value=r;const l=o.value;!l||i.value||m(l,r)};return g.on(ee,u),pt(()=>{g.off(ee,u)}),se(e,d=>{if(o.value=d?.uid?de(d.uid):null,o.value){_(o.value);return}p(a.player.balance)}),{balance:n,setBalance:p,adjustBalance:H}}),Jn={class:"player-balance",role:"status","aria-live":"polite"},Qn={class:"player-balance__value"},Yn=z({__name:"PlayerBalanceDisplay",setup(a){const n=zn(),e=v(()=>`$${(n.balance/100).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}`);return(o,i)=>(f(),D("div",Jn,[y("span",Qn,K(e.value),1)]))}}),qn=J(Yn,[["__scopeId","data-v-bd6f3031"]]);function pe(a,n){const e=a.rules,o=a.table,i=o.activeChair,c=i?.activeHand,p=o.upCard,H=o.trueCountUpper,m=o.trueCountLower;if(!i||!c||!p)return[];const _=!i.validateAction("Split"),u=!i.validateAction("Double"),d=!i.validateAction("Surrender"),r=c.isSoft,l={dealerUpCard:p.value,softValue:c.softValue,canSplit:_,canDouble:u,canSurrender:d,isSoft:r,DAS:e.doubleAllowedAfterSplit};if(!p||!c)throw new Error("Could not determine correct action");const M=Xn(c,p),C=n[M]??[],b=C.find(T=>ne(l,H,T)),E=C.find(T=>ne(l,m,T));if(!b?.action||!E?.action)throw`Missing default rule for ${c.softValue} vs ${p.value}`;return[b.action,E.action]}const ne=(a,n,e)=>!(e.isSoft&&!a.isSoft||e.canDouble&&!a.canDouble||e.canSplit&&!a.canSplit||e.canSurrender&&!a.canSurrender||e.DAS&&!a.DAS),Xn=(a,n)=>{const e=n.value;return`${a.softValue}_${e}`},Nt={id:"basicStrategyH17","2_2":[{canSplit:!0,action:"Split"},{action:"Hit"}],"2_3":[{canSplit:!0,action:"Split"},{action:"Hit"}],"2_4":[{canSplit:!0,action:"Split"},{action:"Hit"}],"2_5":[{canSplit:!0,action:"Split"},{action:"Hit"}],"2_6":[{canSplit:!0,action:"Split"},{action:"Hit"}],"2_7":[{canSplit:!0,action:"Split"},{action:"Hit"}],"2_8":[{canSplit:!0,action:"Split"},{action:"Hit"}],"2_9":[{canSplit:!0,action:"Split"},{action:"Hit"}],"2_10":[{canSplit:!0,action:"Split"},{action:"Hit"}],"2_1":[{canSplit:!0,action:"Split"},{action:"Hit"}],"3_2":[{action:"Hit"}],"3_3":[{action:"Hit"}],"3_4":[{action:"Hit"}],"3_5":[{isSoft:!0,canDouble:!0,action:"Double"},{action:"Hit"}],"3_6":[{isSoft:!0,canDouble:!0,action:"Double"},{action:"Hit"}],"3_7":[{action:"Hit"}],"3_8":[{action:"Hit"}],"3_9":[{action:"Hit"}],"3_10":[{action:"Hit"}],"3_1":[{action:"Hit"}],"4_2":[{canSplit:!0,DAS:!0,action:"Split"},{action:"Hit"}],"4_3":[{canSplit:!0,DAS:!0,action:"Split"},{action:"Hit"}],"4_4":[{canSplit:!0,action:"Split"},{action:"Hit"}],"4_5":[{isSoft:!0,canDouble:!0,action:"Double"},{canSplit:!0,action:"Split"},{action:"Hit"}],"4_6":[{isSoft:!0,canDouble:!0,action:"Double"},{canSplit:!0,action:"Split"},{action:"Hit"}],"4_7":[{canSplit:!0,action:"Split"},{action:"Hit"}],"4_8":[{action:"Hit"}],"4_9":[{action:"Hit"}],"4_10":[{action:"Hit"}],"4_1":[{action:"Hit"}],"5_2":[{action:"Hit"}],"5_3":[{action:"Hit"}],"5_4":[{isSoft:!0,canDouble:!0,action:"Double"},{action:"Hit"}],"5_5":[{isSoft:!0,canDouble:!0,action:"Double"},{action:"Hit"}],"5_6":[{isSoft:!0,canDouble:!0,action:"Double"},{action:"Hit"}],"5_7":[{action:"Hit"}],"5_8":[{action:"Hit"}],"5_9":[{action:"Hit"}],"5_10":[{action:"Hit"}],"5_1":[{action:"Hit"}],"6_2":[{canSplit:!0,DAS:!0,action:"Split"},{action:"Hit"}],"6_3":[{canSplit:!0,DAS:!0,action:"Split"},{action:"Hit"}],"6_4":[{isSoft:!0,canDouble:!0,action:"Double"},{canSplit:!0,action:"Split"},{action:"Hit"}],"6_5":[{isSoft:!0,canDouble:!0,action:"Double"},{canSplit:!0,action:"Split"},{action:"Hit"}],"6_6":[{isSoft:!0,canDouble:!0,action:"Double"},{canSplit:!0,action:"Split"},{action:"Hit"}],"6_7":[{canSplit:!0,action:"Split"},{action:"Hit"}],"6_8":[{action:"Hit"}],"6_9":[{action:"Hit"}],"6_10":[{action:"Hit"}],"6_1":[{action:"Hit"}],"7_2":[{action:"Hit"}],"7_3":[{isSoft:!0,canDouble:!0,action:"Double"},{action:"Hit"}],"7_4":[{isSoft:!0,canDouble:!0,action:"Double"},{action:"Hit"}],"7_5":[{isSoft:!0,canDouble:!0,action:"Double"},{action:"Hit"}],"7_6":[{isSoft:!0,canDouble:!0,action:"Double"},{action:"Hit"}],"7_7":[{action:"Hit"}],"7_8":[{action:"Hit"}],"7_9":[{action:"Hit"}],"7_10":[{action:"Hit"}],"7_1":[{action:"Hit"}],"8_2":[{isSoft:!0,canDouble:!0,action:"Double"},{isSoft:!0,action:"Stand"},{action:"Hit"}],"8_3":[{isSoft:!0,canDouble:!0,action:"Double"},{isSoft:!0,action:"Stand"},{action:"Hit"}],"8_4":[{isSoft:!0,canDouble:!0,action:"Double"},{isSoft:!0,action:"Stand"},{action:"Hit"}],"8_5":[{isSoft:!0,canDouble:!0,action:"Double"},{isSoft:!0,action:"Stand"},{canSplit:!0,DAS:!0,action:"Split"},{action:"Hit"}],"8_6":[{isSoft:!0,canDouble:!0,action:"Double"},{isSoft:!0,action:"Stand"},{canSplit:!0,DAS:!0,action:"Split"},{action:"Hit"}],"8_7":[{isSoft:!0,action:"Stand"},{action:"Hit"}],"8_8":[{isSoft:!0,action:"Stand"},{action:"Hit"}],"8_9":[{action:"Hit"}],"8_10":[{action:"Hit"}],"8_1":[{action:"Hit"}],"9_2":[{isSoft:!0,action:"Stand"},{action:"Hit"}],"9_3":[{isSoft:!0,action:"Stand"},{canDouble:!0,action:"Double"},{action:"Hit"}],"9_4":[{isSoft:!0,action:"Stand"},{canDouble:!0,action:"Double"},{action:"Hit"}],"9_5":[{isSoft:!0,action:"Stand"},{canDouble:!0,action:"Double"},{action:"Hit"}],"9_6":[{isSoft:!0,canDouble:!0,action:"Double"},{isSoft:!0,action:"Stand"},{canDouble:!0,action:"Double"},{action:"Hit"}],"9_7":[{isSoft:!0,action:"Stand"},{action:"Hit"}],"9_8":[{isSoft:!0,action:"Stand"},{action:"Hit"}],"9_9":[{isSoft:!0,action:"Stand"},{action:"Hit"}],"9_10":[{isSoft:!0,action:"Stand"},{action:"Hit"}],"9_1":[{isSoft:!0,action:"Stand"},{action:"Hit"}],"10_2":[{isSoft:!0,action:"Stand"},{canDouble:!0,action:"Double"},{action:"Hit"}],"10_3":[{isSoft:!0,action:"Stand"},{canDouble:!0,action:"Double"},{action:"Hit"}],"10_4":[{isSoft:!0,action:"Stand"},{canDouble:!0,action:"Double"},{action:"Hit"}],"10_5":[{isSoft:!0,action:"Stand"},{canDouble:!0,action:"Double"},{action:"Hit"}],"10_6":[{isSoft:!0,action:"Stand"},{canDouble:!0,action:"Double"},{action:"Hit"}],"10_7":[{isSoft:!0,action:"Stand"},{canDouble:!0,action:"Double"},{action:"Hit"}],"10_8":[{isSoft:!0,action:"Stand"},{canDouble:!0,action:"Double"},{action:"Hit"}],"10_9":[{isSoft:!0,action:"Stand"},{canDouble:!0,action:"Double"},{action:"Hit"}],"10_10":[{isSoft:!0,action:"Stand"},{action:"Hit"}],"10_1":[{isSoft:!0,action:"Stand"},{action:"Hit"}],"11_2":[{canDouble:!0,action:"Double"},{action:"Hit"}],"11_3":[{canDouble:!0,action:"Double"},{action:"Hit"}],"11_4":[{canDouble:!0,action:"Double"},{action:"Hit"}],"11_5":[{canDouble:!0,action:"Double"},{action:"Hit"}],"11_6":[{canDouble:!0,action:"Double"},{action:"Hit"}],"11_7":[{canDouble:!0,action:"Double"},{action:"Hit"}],"11_8":[{canDouble:!0,action:"Double"},{action:"Hit"}],"11_9":[{canDouble:!0,action:"Double"},{action:"Hit"}],"11_10":[{canDouble:!0,action:"Double"},{action:"Hit"}],"11_1":[{canDouble:!0,action:"Double"},{action:"Hit"}],"12_2":[{canSplit:!0,DAS:!0,action:"Split"},{action:"Hit"}],"12_3":[{canSplit:!0,action:"Split"},{action:"Hit"}],"12_4":[{canSplit:!0,action:"Split"},{action:"Stand"}],"12_5":[{canSplit:!0,action:"Split"},{action:"Stand"}],"12_6":[{canSplit:!0,action:"Split"},{action:"Stand"}],"12_7":[{action:"Hit"}],"12_8":[{action:"Hit"}],"12_9":[{action:"Hit"}],"12_10":[{action:"Hit"}],"12_1":[{action:"Hit"}],"13_2":[{action:"Stand"}],"13_3":[{action:"Stand"}],"13_4":[{action:"Stand"}],"13_5":[{action:"Stand"}],"13_6":[{action:"Stand"}],"13_7":[{action:"Hit"}],"13_8":[{action:"Hit"}],"13_9":[{action:"Hit"}],"13_10":[{action:"Hit"}],"13_1":[{action:"Hit"}],"14_2":[{canSplit:!0,action:"Split"},{action:"Stand"}],"14_3":[{canSplit:!0,action:"Split"},{action:"Stand"}],"14_4":[{canSplit:!0,action:"Split"},{action:"Stand"}],"14_5":[{canSplit:!0,action:"Split"},{action:"Stand"}],"14_6":[{canSplit:!0,action:"Split"},{action:"Stand"}],"14_7":[{canSplit:!0,action:"Split"},{action:"Hit"}],"14_8":[{action:"Hit"}],"14_9":[{action:"Hit"}],"14_10":[{action:"Hit"}],"14_1":[{action:"Hit"}],"15_2":[{action:"Stand"}],"15_3":[{action:"Stand"}],"15_4":[{action:"Stand"}],"15_5":[{action:"Stand"}],"15_6":[{action:"Stand"}],"15_7":[{action:"Hit"}],"15_8":[{action:"Hit"}],"15_9":[{action:"Hit"}],"15_10":[{canSurrender:!0,action:"Surrender"},{action:"Hit"}],"15_1":[{canSurrender:!0,action:"Surrender"},{action:"Hit"}],"16_2":[{canSplit:!0,action:"Split"},{action:"Stand"}],"16_3":[{canSplit:!0,action:"Split"},{action:"Stand"}],"16_4":[{canSplit:!0,action:"Split"},{action:"Stand"}],"16_5":[{canSplit:!0,action:"Split"},{action:"Stand"}],"16_6":[{canSplit:!0,action:"Split"},{action:"Stand"}],"16_7":[{canSplit:!0,action:"Split"},{action:"Hit"}],"16_8":[{canSplit:!0,action:"Split"},{action:"Hit"}],"16_9":[{canSplit:!0,action:"Split"},{canSurrender:!0,action:"Surrender"},{action:"Hit"}],"16_10":[{canSplit:!0,action:"Split"},{canSurrender:!0,action:"Surrender"},{action:"Hit"}],"16_1":[{canSurrender:!0,action:"Surrender"},{canSplit:!0,action:"Split"},{action:"Hit"}],"17_2":[{action:"Stand"}],"17_3":[{action:"Stand"}],"17_4":[{action:"Stand"}],"17_5":[{action:"Stand"}],"17_6":[{action:"Stand"}],"17_7":[{action:"Stand"}],"17_8":[{action:"Stand"}],"17_9":[{action:"Stand"}],"17_10":[{action:"Stand"}],"17_1":[{canSurrender:!0,action:"Surrender"},{action:"Stand"}],"18_2":[{canSplit:!0,action:"Split"},{action:"Stand"}],"18_3":[{canSplit:!0,action:"Split"},{action:"Stand"}],"18_4":[{canSplit:!0,action:"Split"},{action:"Stand"}],"18_5":[{canSplit:!0,action:"Split"},{action:"Stand"}],"18_6":[{canSplit:!0,action:"Split"},{action:"Stand"}],"18_7":[{action:"Stand"}],"18_8":[{canSplit:!0,action:"Split"},{action:"Stand"}],"18_9":[{canSplit:!0,action:"Split"},{action:"Stand"}],"18_10":[{action:"Stand"}],"18_1":[{action:"Stand"}],"19_2":[{action:"Stand"}],"19_3":[{action:"Stand"}],"19_4":[{action:"Stand"}],"19_5":[{action:"Stand"}],"19_6":[{action:"Stand"}],"19_7":[{action:"Stand"}],"19_8":[{action:"Stand"}],"19_9":[{action:"Stand"}],"19_10":[{action:"Stand"}],"19_1":[{action:"Stand"}],"20_2":[{action:"Stand"}],"20_3":[{action:"Stand"}],"20_4":[{action:"Stand"}],"20_5":[{action:"Stand"}],"20_6":[{action:"Stand"}],"20_7":[{action:"Stand"}],"20_8":[{action:"Stand"}],"20_9":[{action:"Stand"}],"20_10":[{action:"Stand"}],"20_1":[{action:"Stand"}]},Zn="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict";let Ft=(a=21)=>{let n="",e=crypto.getRandomValues(new Uint8Array(a|=0));for(;a--;)n+=Zn[e[a]&63];return n};const Pt="Games",ta=a=>`gm_${Ft()}`,ea=a=>({deckCount:a.deckCount,dealerHitsSoft17:a.dealerHitsSoft17,doubleAllowedAfterSplit:a.doubleAllowedAfterSplit,resplitAcesAllowed:a.resplitAcesAllowed,surrenderAllowed:a.surrenderAllowed,maxSplits:a.maxSplits,blackjackPayout:a.blackjackPayout,penetration:a.penetration,dealerPeekA10:a.dealerPeekA10}),ve="Rounds",Se=a=>`rnd_${a??Ft()}`,fe=Ht("game",()=>{const a=B(null),n=B(0),e=U.getInstance();async function o(){const H=At().currentUser?.uid;if(!H)return;const m=e.rules,_=ea(m),u=e.table.trueCountLower,d=e.table.trueCountUpper,r=e.table.playerChairArray.map(l=>l.bet);if(!a.value){const l=ta();await Bt(H,[Pt,l],_),a.value=l}await Bt(H,[Pt,a.value,ve,Se(""+n.value)],{startingTrueCountLower:u,startingTrueCountUpper:d,betAmounts:r})}const i=async()=>{n.value++;const p=o();e.table.startRound();try{await p}catch(H){console.error("Failed to persist game",H)}},c=()=>{n.value=0,a.value=null};return g.on(Z(yt),i),g.on(Z(ht),c),pt(()=>{g.off(Z(yt),i),g.off(Z(ht),c)}),{currentGameId:a,roundId:n}}),na="Actions",aa=a=>`act_${Ft()}`,me=["Hit","Stand","Split","Double","Surrender","Insurance"],ae=()=>({Hit:!0,Stand:!0,Split:!1,Double:!1,Surrender:!1,Insurance:!1}),oa=Ht("playerActions",()=>{const a=ie(ae()),n=fe(),e=U.getInstance().table,o=r=>a[r],i=(r,l)=>{a[r]=l},c=r=>{Object.entries(r).forEach(([l,M])=>{a[l]=M})},p=()=>{const r=ae();me.forEach(l=>{a[l]=r[l]})},H=r=>o(r)?(g.emit(Z(ut),{event:ut,action:r}),g.emit(Pe(ut,r),{event:ut,action:r}),!0):!1,m=()=>{g.emit(Z(yt),{event:yt})},_=()=>{g.emit(Z(ht),{event:ht})},u=r=>{const M=At().currentUser?.uid;if(!M)return;const C=n.currentGameId,b=n.roundId;if(!C)throw"no game found when user acted";if(!b)throw"no round found when user acted, gameID"+C;const E=e.activeChair?.activeHand?.cards.map(O=>({value:O.value}));if(!E)throw"no cards found";const T=e.upCard.value;if(!T)throw"no upCard found";const P=e.trueCountLower,A=e.trueCountUpper,j=pe(U.getInstance(),Nt),V={cards:E,upCard:{value:T},startingTrueCountLower:P,startingTrueCountUpper:A,chosenAction:r,strategyId:Nt.id,expectedAction:j};return Bt(M,[Pt,C,ve,Se(b),na,aa()],V)},d=async r=>{if(!r.action||!Ue(r.action)){console.error("failing to act on invalid action",r);return}const l=u(r.action);e.act(r.action),await l};return g.on(Z(ut),d),pt(()=>{g.off(Z(ut),d)}),{enabledMap:a,isEnabled:o,setActionEnabled:i,setMany:c,reset:p,triggerAction:H,play:m,reshuffle:_}}),be=Ht("dealer",()=>{const a=B([]),n=B(U.getInstance().rules.deckCount*52),e=B(U.getInstance().rules.deckCount*52),o=U.getInstance().table.dealer,i=B(0),c=B(!!o.holeCardHidden),p=B(!1),H=B(null),m=L=>{a.value=[...L]},_=L=>{a.value=[...a.value,L]},u=()=>{m([])},d=(L,G)=>{const X=Math.max(1,Math.floor(G)),et=Math.min(X,Math.max(0,Math.floor(L)));n.value=X,e.value=et},r=L=>{const G=e.value+L;e.value=Math.min(n.value,Math.max(0,Math.floor(G)))},l=()=>i.value=Math.trunc(U.getInstance().table.runningCount),M=()=>c.value=U.getInstance().table.dealer.holeCardHidden,C=()=>{n.value=U.getInstance().rules.deckCount*52,e.value=U.getInstance().rules.deckCount*52,p.value=!1,U.getInstance().table.dealer.reset(),U.getInstance().table.dealer.resetDealIndex(),l()},b=()=>{u(),C()};g.on(Z(ht),()=>{b()});const E=[],T=nt("dealer","dealIndex"),P=nt("table","runningCount"),A=nt("dealer","holeCardHidden");function j(L){if(L.value!==0)return;k();const X=L.target.hands[0];if(H.value=mt(X)??null,!H.value)throw new Error("dealer hand not found");I=ft("hand",Wt,H.value),g.on(I,V),g.on(A,V)}function V(){const L=U.getInstance().table.dealerChair.activeHand;m(L.cards),M()}function O(L){if(U.getInstance().table.dealer.pastPenetration()&&(p.value=!0),L.value===0){e.value=U.getInstance().rules.deckCount*52;return}e.value=Math.max(0,e.value-1)}function at(L){i.value=Math.trunc(L.value)}g.on(T,O),g.on(P,at),E.push(()=>g.off(T,O));const q=mt(U.getInstance().table.dealerChair);if(!q)throw new Error("dealer chair not found");let I=null;const k=()=>{I&&(g.off(I,V),g.off(A,V),I=null,H.value=null)},N=Mt("chair","activeHandIndex",q);return g.on(N,j),E.push(()=>{g.off(N,j),k()}),pt(()=>{E.forEach(L=>{try{L()}catch(G){console.error("Failed to cleanup dealer store listener",G)}}),E.length=0,k()}),{cards:a,totalShoeSize:n,remainingShoeSize:e,runningCount:i,pastPenetration:p,holeCardHidden:c,setCards:m,addCard:_,resetCards:u,setShoeSizes:d,adjustShoe:r,resetShoe:C,reset:b}}),ia={class:"action-section","aria-label":"Player actions"},sa=["disabled"],ca={key:1,class:"action-section__content action-section__actions"},ra=["disabled","onClick"],la=z({__name:"ActionSection",setup(a){const n=B(!1),e=B(!1),o=B(!1),i=oa(),c=be(),p=me,H=u=>{try{const d=pe(U.getInstance(),Nt);d.includes(u)||console.log(`Incorrect action chosen: ${u}. Recommended actions: ${Array.from(new Set(d)).join(", ")}`)}catch(d){console.error("Error determining correct action:",d)}i.triggerAction(u)},m=()=>{if(o.value){i.reshuffle();return}i.play()};function _(){const u=U.getInstance().table;if(o.value=c.pastPenetration,e.value=!u.validateRoundCanStart(),!u.aPlayerHasCards){n.value=!1;return}const d=u.activeChair;if(!d||!d.activeHand)return;n.value=!0;const l=d.listViableActions();l&&i.setMany(l)}return g.on(nt("chair","activeHandIndex"),u=>{_()}),g.on(Tt("hand",Wt),u=>{_()}),g.on(nt("chair","bet"),u=>{_()}),g.on(nt("table","chairTurnIndex"),u=>{_()}),g.on(nt("table","runningCount"),u=>{_()}),g.on(Tt("table",ue),u=>{_()}),g.on(nt("dealer","dealIndex"),u=>{_()}),(u,d)=>(f(),D("section",ia,[n.value?(f(),D("div",ca,[(f(!0),D(ct,null,gt(F(p),r=>(f(),D("button",{key:r,class:"action-section__button",type:"button",disabled:!F(i).isEnabled(r),onClick:l=>H(r)},K(r),9,ra))),128))])):(f(),D("button",{key:0,class:"action-section__play action-section__content",type:"button",disabled:!e.value&&!o.value,onClick:d[0]||(d[0]=r=>m())},K(o.value?"Reshuffle":"Play"),9,sa))]))}}),ua=J(la,[["__scopeId","data-v-a2f41c24"]]),da={class:"dealer-section","aria-label":"Dealer hand"},_a={class:"dealer-section__count","aria-live":"polite"},ha={class:"dealer-section__count-value"},pa={class:"dealer-section__content"},va={class:"dealer-shoe","aria-label":"Remaining shoe"},Sa={class:"dealer-shoe__track"},fa=z({__name:"DealerSection",setup(a){const n=be(),e=v(()=>360),o=v(()=>n.holeCardHidden),i=v(()=>{if(!o.value)return n.cards;const[H,...m]=n.cards;return H?[H,{},...m.slice(1)]:[]}),c=v(()=>{const H=n.totalShoeSize||1,m=H>0?n.remainingShoeSize/H:0;return Math.max(0,Math.min(100,Math.round(m*100)))}),p=v(()=>{const H=n.runningCount;return`${H>0?"+":""}${H}`});return(H,m)=>(f(),D("section",da,[y("div",_a,[m[0]||(m[0]=Ut(" Running Count: ",-1)),y("span",ha,K(p.value),1)]),y("div",pa,[y("div",va,[y("div",Sa,[y("div",{class:"dealer-shoe__fill",style:_t({height:`${c.value}%`})},null,4)])]),tt(Dt,{cards:i.value,maxWidth:e.value,large:""},null,8,["cards","maxWidth"])])]))}}),ma=J(fa,[["__scopeId","data-v-d78c6833"]]),ba={class:"table-upper"},ga={class:"table-lower"},Ha=z({__name:"Table",setup(a){const n=Ot();fe();const e=[0,1,2];return(o,i)=>(f(),D(ct,null,[y("div",ba,[tt(ma),tt(ua)]),y("div",ga,[(f(),D(ct,null,gt(e,c=>(f(),D(ct,{key:c},[F(n).getChairView(c)?(f(),rt(Nn,{key:0,"chair-id":c},null,8,["chair-id"])):(f(),rt(Fn,{key:1,"chair-id":c},null,8,["chair-id"]))],64))),64))]),tt(qn)],64))}}),Ca=J(Ha,[["__scopeId","data-v-23c06879"]]),Ia={class:"home-shell"},Da=z({__name:"HomeView",setup(a){return(n,e)=>(f(),D("div",Ia,[tt(qe),tt(Ca)]))}}),xa=J(Da,[["__scopeId","data-v-5c61b5e6"]]);export{xa as default};
